- name: Delete all snapshots from VMs
  hosts: localhost
  gather_facts: no
  vars:
    vcenter_host: "vcenter.example.com"
    vcenter_user: "administrator@vsphere.local"
    vcenter_password: "your_password"
    vm_display_names:
      - "vm-name-1"
      - "vm-name-2"
      - "vm-name-3"

  tasks:
    - name: Delete all snapshots for each VM
      community.vmware.vmware_guest_snapshot:
        hostname: "{{ vcenter_hostname }}"
        username: "{{ vcenter_username }}"
        password: "{{ vcenter_password }}"
        validate_certs: no
        datacenter: "EDCCOE"
        name: "{{ item }}"
        state: remove_all
      loop: "{{ vm_list }}"
      delegate_to: localhost
